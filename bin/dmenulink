#!/bin/bash

[ -z "$@" ] && exit
[ -z "$MENU" ] && MENU=dmenu

selstr="copy\nterminal_browser\ngui_browser\ndownloader\nmedia_viewer\nyoutube-dl"

ch=$(echo -e $selstr | $MENU)

[ "$ch" = "copy" ] && echo "$@" | xclip -selection clipboard &>/dev/null &
[ "$ch" = "gui_browser" ] && $BROWSER "$@" &>/dev/null &
[ "$ch" = "terminal_browser" ] && $TERMINAL -e $TERMINAL_BROWSER "$@" &>/dev/null &
[ "$ch" = "downloader" ] && $TERMINAL -e $DOWNLOADER "$@" &>/dev/null &

if [ "$ch" = "media_viewer" ]; then
	if [ "$MEDIA_PLAYER" = "mpv" ]; then
		qu=$(echo -e "240\n360\n480\n720" | $MENU)
		mpv --ytdl-format="bestvideo[height<=?$qu]+bestaudio/best" "$@" &>/dev/null &
	else
		$MEDIA_PLAYER "$@" &> /dev/null &
	fi
fi


if [ "$ch" = "youtube-dl" ]; then
	qu=$(echo -e "240\n360\n480\n720" | $MENU)
	$TERMINAL -e youtube-dl --add-metadata -ic -f "bestvideo[height<=$qu]+bestaudio/best[height<=$qu]" "$@" &>/dev/null &
fi

